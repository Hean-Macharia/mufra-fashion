{% extends "base.html" %}

{% block title %}Register - MUFRA FASHIONS{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0"><i class="fas fa-user-plus me-2"></i>Create Account</h3>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('register') }}">
                        <div class="mb-3">
                            <label class="form-label">Full Name *</label>
                            <input type="text" class="form-control" name="name" 
                                   value="{{ request.form.name if request.form }}" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Email Address *</label>
                            <input type="email" class="form-control" name="email" 
                                   value="{{ request.form.email if request.form }}" required>
                            <!-- CHANGED: Updated email description -->
                            <div class="form-text">Used for order notifications and account recovery</div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Phone Number *</label>
                            <div class="input-group">
                                <span class="input-group-text">+254</span>
                                <input type="tel" class="form-control" name="phone" 
                                       value="{{ request.form.phone if request.form }}" 
                                       pattern="[0-9]{9}" placeholder="712345678" required>
                            </div>
                            <div class="form-text">Enter your 9-digit phone number without the leading 0</div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Password *</label>
                            <input type="password" class="form-control" name="password" 
                                   id="password" required>
                            <!-- CHANGED: Updated password requirements -->
                            <div class="form-text">Minimum 6 characters</div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="form-label">Confirm Password *</label>
                            <input type="password" class="form-control" name="confirm_password" 
                                   id="confirm_password" required>
                            <div class="invalid-feedback" id="password-error">
                                Passwords do not match
                            </div>
                        </div>
                        
                        <div class="form-check mb-4">
                            <input class="form-check-input" type="checkbox" id="terms" required>
                            <label class="form-check-label" for="terms">
                                I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">Terms and Conditions</a> and <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">Privacy Policy</a> *
                            </label>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-user-plus me-2"></i> Create Account
                            </button>
                        </div>
                        
                        <!-- ADDED: Instant registration notice -->
                        <div class="alert alert-info mt-3" role="alert">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Instant Registration:</strong> Your account is created immediately. No email verification needed!
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="text-center">
                            <p class="mb-0">Already have an account? 
                                <a href="{{ url_for('login') }}" class="text-decoration-none">
                                    Login here
                                </a>
                            </p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Terms Modal -->
<div class="modal fade" id="termsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Terms and Conditions</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <h6>1. Acceptance of Terms</h6>
                <p>By creating an account with MUFRA FASHIONS, you agree to be bound by these terms and conditions.</p>
                
                <h6>2. Account Registration</h6>
                <p>You must provide accurate and complete information when creating an account. You are responsible for maintaining the confidentiality of your account credentials.</p>
                
                <h6>3. Ordering and Payment</h6>
                <p>All orders are subject to availability and confirmation of the order price. We reserve the right to refuse any order.</p>
                
                <h6>4. Delivery</h6>
                <p>Delivery times are estimates and not guaranteed. Risk of loss passes to you upon delivery.</p>
                
                <h6>5. Returns and Refunds</h6>
                <p>Returns are accepted within 7 days of delivery for items in original condition. Refunds will be processed within 14 business days.</p>
                
                <h6>6. Privacy</h6>
                <p>Your personal information will be handled in accordance with our Privacy Policy.</p>
                
                <h6>7. Modifications</h6>
                <p>We reserve the right to modify these terms at any time. Continued use of the service constitutes acceptance of modified terms.</p>
                
                <h6>8. Limitation of Liability</h6>
                <p>MUFRA FASHIONS shall not be liable for any indirect, incidental, or consequential damages arising from your use of our services.</p>
            </div>
        </div>
    </div>
</div>

<!-- Privacy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Privacy Policy</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <h6>1. Information We Collect</h6>
                <p>We collect personal information you provide when registering, placing orders, or contacting us, including name, email, phone number, and shipping address.</p>
                
                <h6>2. How We Use Your Information</h6>
                <p>To process orders, communicate with you about your orders, improve our services, and send promotional materials (with your consent).</p>
                
                <h6>3. Information Sharing</h6>
                <p>We do not sell your personal information. We may share with payment processors, delivery services, and fraud prevention services as necessary to fulfill orders.</p>
                
                <h6>4. Data Security</h6>
                <p>We implement industry-standard security measures to protect your personal information from unauthorized access, alteration, or destruction.</p>
                
                <h6>5. Your Rights</h6>
                <p>You can access, correct, or delete your personal information through your account settings. You may also opt-out of marketing communications at any time.</p>
                
                <h6>6. Cookies and Tracking</h6>
                <p>We use cookies to improve your browsing experience and analyze website traffic. You can control cookies through your browser settings.</p>
                
                <h6>7. Children's Privacy</h6>
                <p>Our services are not directed to individuals under 18. We do not knowingly collect personal information from children.</p>
                
                <h6>8. Changes to Privacy Policy</h6>
                <p>We may update this policy periodically. Continued use of our services constitutes acceptance of the updated policy.</p>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
$(document).ready(function() {
    // Password confirmation
    $('#confirm_password').on('input', function() {
        const password = $('#password').val();
        const confirm = $(this).val();
        
        if (password !== confirm) {
            $(this).addClass('is-invalid');
            $('#password-error').show();
        } else {
            $(this).removeClass('is-invalid');
            $('#password-error').hide();
        }
    });
    
    // Form validation - UPDATED for 6 character minimum
    $('form').submit(function(e) {
        const password = $('#password').val();
        const confirm = $('#confirm_password').val();
        
        if (password !== confirm) {
            e.preventDefault();
            showToast('Error', 'Passwords do not match', 'error');
            return false;
        }
        
        // CHANGED: Updated to 6 characters minimum
        if (password.length < 6) {
            e.preventDefault();
            showToast('Error', 'Password must be at least 6 characters', 'error');
            return false;
        }
        
        if (!$('#terms').is(':checked')) {
            e.preventDefault();
            showToast('Error', 'Please accept the terms and conditions', 'error');
            return false;
        }
    });
    
    // Show toast notification function
    function showToast(title, message, type = 'info') {
        // Create toast element
        const toastId = 'toast-' + Date.now();
        const toastHtml = `
            <div id="${toastId}" class="toast align-items-center text-white bg-${type === 'error' ? 'danger' : type} border-0" role="alert">
                <div class="d-flex">
                    <div class="toast-body">
                        <strong>${title}</strong><br>${message}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            </div>
        `;
        
        // Add to toast container
        if (!$('.toast-container').length) {
            $('body').append('<div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 9999"></div>');
        }
        
        $('.toast-container').append(toastHtml);
        
        // Show toast
        const toast = new bootstrap.Toast(document.getElementById(toastId));
        toast.show();
        
        // Remove after hide
        document.getElementById(toastId).addEventListener('hidden.bs.toast', function () {
            this.remove();
        });
    }
});
</script>
{% endblock %}
{% endblock %}